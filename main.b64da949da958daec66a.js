(()=>{"use strict";var e={391:(e,t,n)=>{n.r(t)},331:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.App=void 0;const a=n(421),r=n(921),i=n(806),s=n(647);t.App=class{constructor(e){this.rootElement=e,this.header=new r.Header,this.inputCreate=new i.AllInputs,this.garage=new a.GarageContainer,this.serverInstruction=new s.ServerInstruction}createHeader(){this.rootElement.appendChild(this.header.element)}createInputs(){this.rootElement.appendChild(this.inputCreate.element)}createGarage(){this.rootElement.appendChild(this.garage.element),this.serverInstruction.howMutchCars(),this.serverInstruction.fillGarage(1)}}},455:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BaseComponent=void 0,t.BaseComponent=class{constructor(e="div",t=[]){this.element=document.createElement(e),this.element.classList.add(...t)}}},979:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Button=void 0;const a=n(455);class r extends a.BaseComponent{constructor(e,t){super("button",["button"]),this.element.id=e,this.element.innerText=t}}t.Button=r},421:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GarageContainer=void 0;const a=n(455),r=n(905),i=n(647);class s extends a.BaseComponent{constructor(){super("section",["garage"]),this.garagePage=new r.GaragePage,this.pageDisplay=document.createElement("div"),this.carCounter=document.createElement("h2"),this.nextBtn=document.createElement("button"),this.prevBtn=document.createElement("button"),this.serverInstructions=new i.ServerInstruction,this.carCounter.classList.add("garage-counter"),this.carCounter.id="carCounter",this.nextBtn.innerText="next",this.prevBtn.innerText="prev",this.nextBtn.classList.add("button"),this.prevBtn.classList.add("button"),this.pageDisplay.classList.add("garage-page__number"),this.pageDisplay.id="pageNumber",this.element.appendChild(this.carCounter),this.element.appendChild(this.pageDisplay),this.element.appendChild(this.garagePage.element),this.element.appendChild(this.prevBtn),this.element.appendChild(this.nextBtn),this.pageNext(),this.pagePrev()}pageCounter(e){this.pageDisplay.innerText=`Page: ${e}`}pageNext(){this.serverInstructions.howMutchCars(),this.nextBtn.addEventListener("click",(e=>{this.serverInstructions.nextPage()}))}pagePrev(){this.prevBtn.addEventListener("click",(()=>{this.serverInstructions.prevPage()}))}}t.GarageContainer=s},575:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GarageHeader=void 0;const a=n(455),r=n(647);class i extends a.BaseComponent{constructor(e,t,n){super("div",["garage-header"]),this.serverInstructions=new r.ServerInstruction,this.addRemoveListner(n),this.addSelectListner(n,e,t),this.addAId(n),this.addBId(n),this.addCarName(e,n)}addCarName(e,t){const n=document.createElement("h3");n.id=`car-name-${t}`,n.classList.add("car-name"),n.innerText=`${e}`,this.element.appendChild(n)}addBId(e){const t=document.createElement("button");t.innerText="B",t.id=`b-${e}`,t.classList.add("car-reset"),this.element.appendChild(t)}addAId(e){const t=document.createElement("button");t.innerText="A",t.id=`a-${e}`,t.classList.add("car-move"),t.addEventListener("click",(()=>{this.serverInstructions.startCar(e)})),this.element.appendChild(t)}addRemoveListner(e){const t=document.createElement("button");t.innerText="remove",t.id=`remove-${e}`,t.classList.add("button"),t.addEventListener("click",(()=>{const t=document.getElementById(`garage-${e}`);null==t||t.remove(),this.serverInstructions.removeCar(e)})),this.element.appendChild(t)}addSelectListner(e,t,n){const a=document.createElement("button");a.innerText="select",a.id=`select-${e}`,a.classList.add("button"),a.addEventListener("click",(()=>{const a=document.getElementById("carNameEdit"),r=document.getElementById("carColorEdit");a.value=t,a.name=`${e}`,r.value=n})),this.element.appendChild(a)}}t.GarageHeader=i},181:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GarageItem=void 0;const a=n(455);class r extends a.BaseComponent{constructor(e){super("div",["garage-item"]),this.element.id=`garage-${e}`}}t.GarageItem=r},873:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GarageTrack=void 0;const a=n(455);class r extends a.BaseComponent{constructor(e,t){super("div",["garage-track"]),this.color=e,this.carId=t,this.fillCar()}fillCar(){this.element.innerHTML=`\n      <div class = "car-wrapper" name = "${this.carId}">\n        <svg  viewBox="0 0 16 16" id = "car-${this.carId}" style="fill:${this.color}" width = "50px" xmlns="http://www.w3.org/2000/svg">\n          <path d="m14.794 5.1662-1.12213-3.74042c-.255859-.853027-1.02588-1.42578-1.91602-1.42578h-7.51172c-.890137 0-1.66016.572754-1.91602 1.42578l-1.12213 3.74042c-.708557.307922-1.20599 1.01306-1.20599 1.8338v4c0 .552246.447754 1 1 1h.000061l-.000061.999939c0 .552307.447693 1.00006 1 1.00006h1.00006c.552246 0 1-.447754 1-1l-.0004272-1h8.00037l-.000061.999939c0 .552307.447693 1.00006 1 1.00006h1.00006c.552307 0 1-.447754 1-1v-.999939l-.0003662-.000061h.0003662c.552246 0 1-.447754 1-1v-4c0-.82074-.497436-1.52588-1.20599-1.8338zm-10.5499-3.1662h7.51172l.900024 3h-9.31177l.900024-3zm-.244141 7.5c-.552307 0-1-.447754-1-1 0-.552307.447693-1 1-1s1 .447693 1 1c0 .552246-.447693 1-1 1zm8 0c-.552307 0-1-.447754-1-1 0-.552307.447693-1 1-1s1 .447693 1 1c0 .552246-.447693 1-1 1z" transform="translate(0 1)"/>\n        </svg>\n      </div>\n    `}}t.GarageTrack=r},905:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GaragePage=void 0;const a=n(455);class r extends a.BaseComponent{constructor(){super("div",["garage-page"]),this.element.id="garagePage"}}t.GaragePage=r},921:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Header=void 0;const a=n(455),r=n(979);class i extends a.BaseComponent{constructor(){super("header",["header"]),this.toGarage=new r.Button("toGarage","to garage"),this.toScore=new r.Button("toScore","to score"),this.element.appendChild(this.toGarage.element),this.element.appendChild(this.toScore.element)}}t.Header=i},806:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AllInputs=void 0;const a=n(455),r=n(240),i=n(763),s=n(746);class o extends a.BaseComponent{constructor(){super("section",["form"]),this.inputCreate=new r.InputCreate,this.inputEdit=new i.InputEdit,this.managerButton=new s.MangerButtons,this.element.appendChild(this.inputCreate.element),this.element.appendChild(this.inputEdit.element),this.element.appendChild(this.managerButton.element)}}t.AllInputs=o},240:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.InputCreate=void 0;const a=n(455),r=n(575),i=n(181),s=n(873);class o extends a.BaseComponent{constructor(){super("form",["form-header"]),this.inputCarCreate=document.createElement("input"),this.inputCarColor=document.createElement("input"),this.button=document.createElement("button"),this.inputCarCreate.type="text",this.inputCarCreate.id="carNameCreate",this.inputCarColor.type="color",this.inputCarColor.id="carNameCreate",this.inputCarColor.value="#000",this.button.type="submit",this.button.id="createCar",this.button.classList.add("button"),this.button.innerText="create",this.element.appendChild(this.inputCarCreate),this.element.appendChild(this.inputCarColor),this.element.appendChild(this.button),this.addCreateListner()}addCreateListner(){this.button.addEventListener("click",(e=>{e.preventDefault();const t={name:this.inputCarCreate.value,color:this.inputCarColor.value};0!==t.name.length?fetch("http://127.0.0.1:3000/garage",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then((e=>e.json())).then((e=>{var t;const n=document.querySelectorAll(".garage-item");if(n.length<7){const a=new i.GarageItem(e.id),o=new r.GarageHeader(e.name,e.color,e.id),d=new s.GarageTrack(e.color,e.id);a.element.appendChild(o.element),a.element.appendChild(d.element),null===(t=n[0].parentElement)||void 0===t||t.appendChild(a.element)}})).finally((()=>{this.inputCarColor.value="#000000",this.inputCarCreate.value=""})):alert("ERROR: Name length is 0")}))}}t.InputCreate=o},763:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.InputEdit=void 0;const a=n(455),r=n(647);class i extends a.BaseComponent{constructor(){super("form",["form-header"]),this.inputCarEdit=document.createElement("input"),this.inputCarColor=document.createElement("input"),this.button=document.createElement("button"),this.serverInsructions=new r.ServerInstruction,this.inputCarEdit.type="text",this.inputCarEdit.id="carNameEdit",this.inputCarColor.type="color",this.inputCarColor.id="carColorEdit",this.inputCarColor.value="#000000",this.button.type="submit",this.button.id="editCar",this.button.classList.add("button"),this.button.innerText="edit",this.element.appendChild(this.inputCarEdit),this.element.appendChild(this.inputCarColor),this.element.appendChild(this.button),this.inputUpdate()}inputUpdate(){this.button.addEventListener("click",(e=>{e.preventDefault();const t=this.inputCarEdit.value,n=this.inputCarColor.value,a=this.inputCarEdit.name;if(0===a.length||0===t.length)return void alert("Choose car or init name");this.serverInsructions.editCar(n,t,a);const r=document.getElementById(`car-name-${a}`),i=this.inputCarColor.value,s=document.getElementById(`car-${a}`);null!==r&&null!==s&&(s.style.fill=i,r.innerText=this.inputCarEdit.value,this.inputCarEdit.value="",this.inputCarEdit.name="",this.inputCarColor.value="#000000")}))}}t.InputEdit=i},746:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MangerButtons=void 0;const a=n(455),r=n(647);class i extends a.BaseComponent{constructor(){super("div",["form-manager"]),this.ServerInstruction=new r.ServerInstruction,this.buttonGenerate=document.createElement("button"),this.buttonStart=document.createElement("button"),this.buttonStart.classList.add("button"),this.buttonStart.id="startRace",this.buttonStart.innerText="start";const e=document.createElement("button");e.classList.add("button"),e.id="resetRace",e.innerText="reset",this.buttonGenerate.classList.add("button"),this.buttonGenerate.id="generateCars",this.buttonGenerate.innerText="generate",this.element.appendChild(this.buttonStart),this.element.appendChild(e),this.element.appendChild(this.buttonGenerate),this.createHundred(),this.start()}createHundred(){this.buttonGenerate.addEventListener("click",(()=>{this.ServerInstruction.createHundredRand()}))}start(){this.buttonStart.addEventListener("click",(()=>{this.ServerInstruction.startAllCars()}))}}t.MangerButtons=i},647:function(e,t,n){var a=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))((function(r,i){function s(e){try{d(a.next(e))}catch(e){i(e)}}function o(e){try{d(a.throw(e))}catch(e){i(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,o)}d((a=a.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.ServerInstruction=void 0;const r=n(575),i=n(873),s=n(181),o=["C","Java","Python","D","PHP","Type","Action","Pascal","Maple","Оберон"],d=["++","Script","#","bc","1","2","3","Оберон","Fusion","Game Maker Language"];let l=[];t.ServerInstruction=class{constructor(){this.CARS_COUNTER=1,this.PAGE_COUNTER=1,this.CURRENT_PAGE=1}removeCar(e){fetch(`http://127.0.0.1:3000/garage/${e}`,{method:"DELETE"}).then((e=>{this.howMutchCars();const t=document.getElementById("garagePage");t&&(t.innerHTML="",this.fillGarage(this.CURRENT_PAGE))}))}editCar(e,t,n){fetch(`http://127.0.0.1:3000/garage/${n}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:t,color:e})})}startAllCars(){l.forEach((e=>{this.startCar(e.id)}))}aBtn(e,t){const n=document.getElementById(`a-${e}`);n&&(n.style.display=!1===t?"none":"block")}startCar(e){var t;this.aBtn(e,!1),(t=e,a(void 0,void 0,void 0,(function*(){return yield fetch(`http://127.0.0.1:3000/engine?id=${t}&status=started`)}))).then((t=>a(this,void 0,void 0,(function*(){var n,r,i;const s=yield t.json(),o=null===(n=document.getElementById(`car-${e}`))||void 0===n?void 0:n.animate([{transform:"translateX(0px)"},{transform:`translateX(${document.body.clientWidth-275}px)`}],{duration:50*s.velocity,easing:"ease-in-out",fill:"forwards"});(e=>a(void 0,void 0,void 0,(function*(){return yield fetch(`http://127.0.0.1:3000/engine?id=${e}&status=drive`)})))(e).then((e=>a(this,void 0,void 0,(function*(){500!==e.status&&404!==e.status||null==o||o.pause()})))),null===(r=document.getElementById(`b-${e}`))||void 0===r||r.addEventListener("click",(()=>{null==o||o.cancel(),this.aBtn(e,!0)})),null===(i=document.getElementById("resetRace"))||void 0===i||i.addEventListener("click",(()=>{null==o||o.cancel(),this.aBtn(e,!0)}))}))))}createHundredRand(){for(let e=0;e<100;e++){const e={name:`${o[Math.floor(10*Math.random())]} ${d[Math.floor(10*Math.random())]}`,color:`#${Math.floor(Math.random()*Math.pow(256,3)).toString(16)}`};fetch("http://127.0.0.1:3000/garage",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})}this.howMutchCars(),this.fillGarage(this.CURRENT_PAGE)}howMutchCars(){const e=[];fetch("http://127.0.0.1:3000/garage",{}).then((e=>e.json())).then((t=>e.push(...t))).then((()=>{const t=document.getElementById("carCounter");t&&(t.innerHTML=`Garage(${e.length})`,this.CARS_COUNTER=e.length,this.PAGE_COUNTER=Math.trunc(this.CARS_COUNTER/7),this.CARS_COUNTER/7>Math.trunc(this.CARS_COUNTER/7)&&(this.PAGE_COUNTER=Math.trunc(this.CARS_COUNTER/7)+1))}))}nextPage(){this.fillGarage(this.CURRENT_PAGE),this.CURRENT_PAGE!==this.PAGE_COUNTER&&(this.CURRENT_PAGE+=1,this.howMutchCars(),this.fillGarage(this.CURRENT_PAGE))}prevPage(){this.fillGarage(this.CURRENT_PAGE),1!==this.CURRENT_PAGE&&(this.CURRENT_PAGE-=1,this.fillGarage(this.CURRENT_PAGE))}fillGarage(e){const t=[];fetch(`http://127.0.0.1:3000/garage?_page=${e}&_limit=7`).then((e=>e.json())).then((e=>t.push(...e))).then((()=>{const e=document.getElementById("garagePage");e&&(e.innerHTML="",t.forEach((t=>{const n=new s.GarageItem(t.id),a=new i.GarageTrack(t.color,t.id),o=new r.GarageHeader(t.name,t.color,t.id);n.element.appendChild(o.element),n.element.appendChild(a.element),null==e||e.appendChild(n.element)})))})),l=t}}}},t={};function n(a){var r=t[a];if(void 0!==r)return r.exports;var i=t[a]={exports:{}};return e[a].call(i.exports,i,i.exports,n),i.exports}n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{n(391);const e=n(331);window.onload=()=>{document.body.id="app";const t=document.getElementById("app");if(!t)throw Error("App root element not found");new e.App(t),new e.App(t).createHeader(),new e.App(t).createInputs(),new e.App(t).createGarage()}})()})();